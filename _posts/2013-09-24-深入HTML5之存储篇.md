深入HTML5之存储【译】
---------------------------

原文链接：[diveintohtml5-storage](http://diveintohtml5.info/storage.html)

下面开始，走你。

**Web App的本地存储的过去，现在和未来**

## 目录

- 来，潜水吧，深一点
- HTML5史前时期的本地存储
- HTML5存储那点事儿
- 使用HTML5存储
- 追踪HTML5存储区发生的改变
- 现代浏览器那些得瑟的龟毛
- 真的干一场吧，用HTML5存储
- 除了键值队，我们还能怎么搞
- 一些福利

### Diving In
长期以来，*永久性的本地存储*是native app秒杀web app的一大利器。对于native app，OS常常会提供一个抽象层专门为其提供应用相关的数据请求的存取。这些值被存在诸如寄存器、INI文件、XML文件或者依赖于平台惯例的定义的其他地方。而且如果你的native app的数据处理需求远远超过只由key/value提供的基本功能，那么OS甚至允许你自己嵌入DB，使用你自定义的文件类型，或者其他的解决方案。

历史以来，web app就像是后娘养的，从来就没有这些福利待遇，只能眼巴巴地可怜兮兮地用着cookie而已。但是你懂的，这玩意只能用于小量的数据存储，还你Y的会expire呀，而现在这种SPA的大时代下，显然是不够塞牙缝的。下面来看看cookie的几个违反规矩的缺点(dealbreaking downsides)吧。

+ 在每个http请求过程中，cookie总是会被携带着，真是个累赘，增加了web app响应的速度，有时候就算明明没有任何更新，也还是得带上它，完全就是在花无用功在宝贵的带宽中来来回回地传输没有意义的相同的数据。
+ 如上所述，每个http请求来回过程中，cookie其实是没有经过编码的，除非你的整个web app是基于SSL支持的，否则安全性存在问题。
+ 最致命的弱点，简直是硬伤呀，4KB的数据，够干嘛的呀，传一张私密图片，木有了~~但是4KB每次http来回过程中都携带，明显让你的加载慢死，它慢就慢吧，关键是只有4KB还带不来任何别的实质性的好处。

那么在web端我们真正需要的是怎么样的存储呢？
- 好大一块地盘可以用来存货，最好是一整个码头（自己YY的，不喜勿喷）
- 这个地盘只要在用户代理这一端维护就可以了
- 无论页面是否重新加载，这块地盘上的数据是持久的
- 当然，可不许像cookie一样sx还要来回于server之间，那样就只是个更傻的大个而已

### 史前时期的web本地存储解决方案
- **IE userData**：允许每个站点存64KB数据，对于信任站点（intranet）这个值可以是640KB，它是借助DHTML的behaviour属性来存储本地数据的。
- **Adobe Flash cookie**：2002年，跟着Flash6出来的本来应该被成为本地共享对象（LSO）的一个特性，却被戏称为Flash cookie了。这个特性允许Flash对象可以存储达100KB大小的数据/domain。Brad Neuberg开发的Flash转Js的原型：*AMASS*（Ajax Massive Sotrage System）允许Js获取LSOs，并且集成到Dojo Toolkit中。这个后来成为*dojox.storage*。这个项目到2009年时可以自动检测基于Flash，Gears，Adobe AIR以及HTML5早期原型的存储。
- **Google Gears**：2007年，Google发布Gears，一款开源的浏览器插件，内置了一套基于SQLite的嵌入式SQL数据库系统，并且提供了统一的API对其进行访问。2010年停止更新。

综上所述，每个模式总是争对单一的浏览器提出的解决方案，或者是依赖于第三方插件，提供的API都是不相同的，存储的限制也不尽相同，更别说大为迥异的用户体验了。所以这就是HTML5闪亮登场想要拯救世界的感觉，啪，HTML5本地存储出现了--提供一套标准的API，不需要依赖第三方插件而且在各种浏览器上的本地实现保持高度的一致性。

### HTML5存储
